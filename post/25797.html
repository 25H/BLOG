<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=renderer content=webkit><meta name=force-rendering content=webkit><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=generator content="Hugo 0.57.2"><meta name=author content=25H><meta name=copyright content=ARAE><meta name=robots content=all><meta name=keywords content=AMZ,AMZ-DevDoc><meta name=description content='由 AMZ 预定义或二次封装的一些接口，balabalabala&amp;hellip; .版本 2 .DLL命令 amz_api_OpenSet, , "AMZ.fne", "amz_api_OpenSet", 公开, 打开 设置 .参数 szGuid, 文本型, , 插件的GUID，可空 .DLL …'><title>AMZ (API)公共扩展插件编写接口 - ARAE</title><link rel=icon href=/images/favicon.png><link rel=canonical href=https://blog.arae.cc/post/25797.html><link rel=stylesheet href=/assets/style.min.css><script src=/assets/script.min.js></script></head><body><div id=kratos-wrapper><div id=kratos-page><div id=kratos-header><header id=kratos-header-section><div class=container><div class=nav-header><nav id=kratos-menu-wrap class=menu-main-container><ul id=kratos-primary-menu class=sf-menu><li class=current-menu-item><a href=/ aria-current=page><i class="fa fa-home"></i>&nbsp;首页</a></li><li><a href=/categories/%E7%8A%B6%E6%80%81.html><i class="fa fa-at"></i>&nbsp;状态</a></li><li><a href=javascript:;><i class="fa fa-folder-o"></i>&nbsp;分类</a><ul class=sub-menu><li><a href=/categories/code.html>Coding</a></li><li><a href=/categories/%E4%BD%9C%E5%93%81.html>作品</a></li><li><a href=/categories/%E7%AC%94%E8%AE%B0.html>笔记</a></li><li><a href=/categories/%E8%BD%AC%E8%BD%BD.html>转载</a></li><li><a href=/categories/%E6%9C%AA%E5%88%86%E7%B1%BB.html>未分类</a></li></ul></li><li><a href=/z/projects.html><i class="fa fa-bug"></i>&nbsp;项目</a></li><li><a href=/z/links.html><i class="fa fa-mars"></i>&nbsp;友链</a></li><li><a href=/z/about.html><i class="fa fa-rocket"></i>&nbsp;关于</a></li></ul></nav></div></div></header></div><div class="kratos-start kratos-hero-2"><div class=kratos-overlay></div><div class="kratos-cover kratos-cover_2 text-center"><div class="desc desc2 animate-box"><a href=https://blog.arae.cc/><h2>25H's Blog</h2><br><span></span></a></div></div></div><div id=kratos-blog-post style=background:#f5f5f5><div id=container class=container style=opacity:1><div class=row><section id=main class=col-md-8><article><div class="kratos-hentry kratos-post-inner clearfix"><header class=kratos-entry-header><h1 class="kratos-entry-title text-center">AMZ (API)公共扩展插件编写接口</h1><div class="kratos-post-meta text-center"><span title="2018-09-21 23:23:22"><i class="fa fa-calendar"></i>&nbsp;2018年09月21日</span>
<span><i class="fa fa-folder-o"></i>&nbsp;<a class=label href=/categories/%E7%AC%94%E8%AE%B0.html>笔记</a></span><span title="文章字数： ≈ 2279 字"><i class="fa fa-file-word-o"></i>&nbsp;2.28k</span>
<span title="阅读时长： ≈ 5 分钟"><i class="fa fa-clock-o"></i>&nbsp;5min</span>
<span><i class="fa fa-user"></i>&nbsp;25H</span></div></header><div class=kratos-post-content><blockquote><p>由 AMZ 预定义或二次封装的一些接口，balabalabala&hellip;</p></blockquote><pre class=ecode desc="AMZ API">
.版本 2

.DLL命令 amz_api_OpenSet, , "AMZ.fne", "amz_api_OpenSet", 公开, 打开 设置
    .参数 szGuid, 文本型, , 插件的GUID，可空

.DLL命令 amz_api_OutText, , "AMZ.fne", "amz_api_OutText", 公开, 向输出框发送文本
    .参数 szStr, 文本型

.DLL命令 amz_api_OutText_1, , "AMZ.fne", "amz_api_OutText_1", 公开, 向输出框发送文本，无版权
    .参数 szStr, 文本型

.DLL命令 amz_api_OutTextError, , "AMZ.fne", "amz_api_OutTextError", 公开, 向输出框发送文本，带错误提示声音
    .参数 szStr, 文本型

.DLL命令 amz_api_OutTextEmpty, , "AMZ.fne", "amz_api_OutTextEmpty", 公开, 清空输出框内容

.DLL命令 amz_api_GetRunFunc, 整数型, "AMZ.fne", "amz_api_GetRunFunc", 公开, 获取 IDE功能函数地址

.DLL命令 amz_api_GetHwnd, 整数型, "AMZ.fne", "amz_api_GetHwnd", 公开, 取易语言自身控件句柄，后期创建的可能获取不到，如果出现重复的ID类型可填写上层ID类名进行二次获取
    .参数 nIDDlgItem, 整数型, , 控件ID
    .参数 szClassName, 文本型, , 类名，可空

.DLL命令 amz_api_GetHwnd_OutText, 整数型, "AMZ.fne", "amz_api_GetHwnd_OutText", 公开, 获取 输出框句柄

.DLL命令 amz_api_GetEhWnd, 整数型, "AMZ.fne", "amz_api_GetEhWnd", 公开, 获取 易语言主窗口句柄

.DLL命令 amz_api_GetPID, 整数型, "AMZ.fne", "amz_api_GetPID", 公开, 获取 易语言进程PID

.DLL命令 amz_api_GetEver, 小数型, "AMZ.fne", "amz_api_GetEver", 公开, 获取 易语言版本号

.DLL命令 amz_api_GetDir_E, 文本型, "AMZ.fne", "amz_api_GetDir_E", 公开, 获取目录 易语言主目录

.DLL命令 amz_api_GetDir_AMZ, 文本型, "AMZ.fne", "amz_api_GetDir_AMZ", 公开, 获取目录 AMZ目录

.DLL命令 amz_api_GetDir_Plugin, 文本型, "AMZ.fne", "amz_api_GetDir_Plugin", 公开, 获取目录 自身插件目录
    .参数 szGuid, 文本型, , 插件的GUID，必填

.DLL命令 amz_api_GetDir_Project, 文本型, "AMZ.fne", "amz_api_GetDir_Project", 公开, 获取目录 当前源码所在目录，失败返回空

.DLL命令 amz_api_GetPath_Project, 文本型, "AMZ.fne", "amz_api_GetPath_Project", 公开, 获取路径 当前源码的路径，失败返回空

.DLL命令 amz_api_is_NewProject, 逻辑型, "AMZ.fne", "amz_api_is_NewProject", 公开, 判断 易语言是否为新工程，未保存过的，如果为新程序返回真，否则返回假

.DLL命令 amz_api_is_Debug, 逻辑型, "AMZ.fne", "amz_api_is_Debug", 公开, 是否调试运行中，调试中返回真，否则返回假

.DLL命令 amz_api_GetKeyText, 文本型, "AMZ.fne", "amz_api_GetKeyText", 公开, 读配置项
    .参数 szGuid, 文本型, , 「插件的GUID」，必填
    .参数 szKeyName, 文本型, , 「配置项名称」，参数值指定欲读入配置项在其节中的名称。
    .参数 szDefault, 文本型, , 「默认文本」如果指定配置项不存在，将返回此默认文本。如果指定配置项不存在且本参数被省略，将返回空文本。

.DLL命令 amz_api_SetKeyText, 逻辑型, "AMZ.fne", "amz_api_SetKeyText", 公开, 写配置项，成功返回真，失败返回假。
    .参数 szGuid, 文本型, , 「插件的GUID」，必填
    .参数 szKeyName, 文本型, , 「配置项名称」，如果参数值被省略，则删除指定节及其下的所有配置项。
    .参数 szStr, 文本型, , 「写入值」，参数值指定欲写入到指定配置项中的文本。如果参数值被省略，则删除所指定配置项。

.DLL命令 amz_api_AddTab, 逻辑型, "AMZ.fne", "amz_api_AddTab", 公开, 在状态夹中增加一个工作夹.功能被处理返回真,未被处理则返回假.
    .参数 hWnd, 整数型, , 项目句柄
    .参数 hIcon, 整数型, , 图标句柄
    .参数 szCaption, 文本型, , 项目标题
    .参数 szToolTip, 文本型, , 项目提示

.DLL命令 amz_api_ClickMenu, , "AMZ.fne", "amz_api_ClickMenu", 公开, 点击易语言的菜单
    .参数 nMenuID, 整数型, , 菜单ID #菜单_ 开头
    .参数 bIsPostMessageA, 逻辑型, , 默认为假，使用SendMessageA，真将使用 PostMessageA

.DLL命令 amz_api_SetWorkTab, , "AMZ.fne", "amz_api_SetWorkTab", 公开, 工作夹 切换
    .参数 nIndex, 整数型, , #工作夹_ 开头

.DLL命令 amz_api_SetStateTab, , "AMZ.fne", "amz_api_SetStateTab", 公开, 状态夹 切换
    .参数 nIndex, 整数型, , #状态夹_ 开头

.DLL命令 _取当前帮助及类型, 文本型, "AMZ.fne", "_取当前帮助及类型", , _取当前帮助及类型

.DLL命令 _取当前文本及类型, 文本型, "AMZ.fne", "_取当前文本及类型", , _取当前文本及类型

.DLL命令 amz_api_IPC_SendMsg, , "AMZ.fne", "amz_api_IPC_SendMsg", 公开, 多进程通讯，发送消息，该命令可以自由向其他易语言AMZ插件发送消息，但发送端不会收到消息；注：此功能仅允许在主线程内应用！
    .参数 szGuid, 文本型, , 插件的GUID，必填
    .参数 szMsg, 文本型, , 要发送的消息，上限512字符。

.DLL命令 amz_api_AddToolsTabItem, 逻辑型, "AMZ.fne", "amz_api_AddToolsTabItem", 公开, 向“状态夹->Tools”下添加项目。(不限添加数量，此命令在“准备就绪”事件后失效)
    .参数 szGuid, 文本型, , 插件的GUID
    .参数 nID, 整数型, , 用于辩认项的数值
    .参数 szCaption, 文本型, , 项标题
    .参数 szIcon, 文本型, , 项图标； 图片尺寸32*32； 填写格式如：「file:/plugin/img/***.jpg」其中「file:/plugin/」相对于自身插件目录；

.DLL命令 amz_api_WebPage_Add, 逻辑型, "AMZ.fne", "amz_api_WebPage_Add", 公开, 向链表中加入外置Web页面信息
    .参数 szGuid, 文本型, , 插件的GUID
    .参数 nID, 整数型, , 用于辩别页面的数值；
    .参数 szWinTitle, 文本型, , 窗口标题，可空
    .参数 szPageUrl, 文本型, , 页面地址
    .参数 szFPW, 文本型, , 文件密码，可空，为空则正常加载文件；可用 '_SDK\AmzEncrypt\AmzEncrypt.exe' 对文件进行加密，加密支持 *.htm *.html *.css *.js文件
    .参数 nWinWidth, 整数型, , 窗口宽度
    .参数 nWinHeight, 整数型, , 窗口高度
    .参数 bWinMin, 逻辑型, , 是否允许窗口最小化
    .参数 bWinMax, 逻辑型, , 是否允许窗口最大化
    .参数 bWinSizing, 逻辑型, , 是否允许窗口调整尺寸
    .参数 bNotMultiple, 逻辑型, , 不允许多开

.DLL命令 amz_api_WebPage_Open, , "AMZ.fne", "amz_api_WebPage_Open", 公开, 打开链表中的外置Web页面
    .参数 szGuid, 文本型, , 插件的GUID
    .参数 nID, 整数型, , 用于辩别页面的数值；

.DLL命令 amz_api_GetAmzVerMajor, 整数型, "AMZ.fne", "amz_api_GetAmzVerMajor", 公开, 获取 AMZ 主版本号，失败返回 0

.DLL命令 amz_api_GetAmzVerMinor, 整数型, "AMZ.fne", "amz_api_GetAmzVerMinor", 公开, 获取 AMZ 次版本号，失败返回 0

.DLL命令 amz_api_GetAmzVerPatch, 整数型, "AMZ.fne", "amz_api_GetAmzVerPatch", 公开, 获取 AMZ 修订号，失败返回 0

.DLL命令 amz_api_GetAmzVerTag, 文本型, "AMZ.fne", "amz_api_GetAmzVerTag", 公开, 获取 AMZ 版本延伸标签，失败返回 空

.DLL命令 amz_api_GetAmzVerName, 文本型, "AMZ.fne", "amz_api_GetAmzVerName", 公开, 获取 AMZ 完整字符串版本 如：3.1.1_Beta，失败返回 空

.DLL命令 amz_api_GetAmzVer, 小数型, "AMZ.fne", "amz_api_GetAmzVer", 公开, 获取 AMZ 版本号 如：3.11，失败返回 0

.DLL命令 amz_api_ClipboardCopy, 文本型, "AMZ.fne", "amz_api_ClipboardCopy", 公开, 剪辑板 复制，失败返回 空；自动备份还原并返回选中内容；此功能会清空E剪辑历史！

.DLL命令 amz_api_ClipboardPaste, , "AMZ.fne", "amz_api_ClipboardPaste", 公开, 剪辑板 粘贴；自动备份还原并置入指定文本
    .参数 Text, 文本型

</pre><pre class=ecode desc="AMZ WinAPI">
.版本 2

.DLL命令 amz_winapi_GetTempPathA, , "AMZ.fne", "amz_winapi_GetTempPathA", 公开, WinApi 获取 系统临时目录，所返回目录名以“\”符号结束，如失败返回空文本。

.DLL命令 amz_winapi_RtlMoveMemory, , , "RtlMoveMemory", 公开, RtlMoveMemory
    .参数 pDest, 整数型, , 复制到
    .参数 pSrc, 整数型, , 被复制
    .参数 ByteLen, 整数型, , 长度

</pre><hr><p>_ 更新日期：2018-9-21 _</p></div><div class="kratos-copyright text-center clearfix"><h5>本作品采用 <a rel="license nofollow" target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/ title="CC BY-NC-SA 4.0">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a> 进行许可</h5></div><footer class="kratos-entry-footer clearfix"><div class="post-like-donate text-center clearfix"><a href=javascript:; class=Donate><i class="fa fa-bitcoin"></i>&nbsp;打赏</a></div><div class="footer-tag clearfix"><div class=pull-left><i class="fa fa-tags"></i>&nbsp;
<a href=/tags/amz.html rel=tag>AMZ</a>
<a href=/tags/amz-devdoc.html rel=tag>AMZ-DevDoc</a></div><div class=pull-date><span title="2019年08月23日 01:24:24">最后编辑：2019年08月23日</span></div></div></footer></div><nav class="navigation post-navigation clearfix" role=navigation><div class="nav-previous clearfix"><a title="状态 - 25823" href=/t/25823.html>&lt; 上一篇</a></div><div class=nav-next><a title="状态 - 25822" href=/t/25822.html>下一篇 &gt;</a></div></nav><div id=comments class=comments-area><div id=comments-body data-pid=/post/25797.html><p class=mClose>评论功能被我吃了。</p></div></div></article></section><aside id=kratos-widget-area class="col-md-4 hidden-xs hidden-sm scrollspy"><div id=sidebar class=affix-top><aside class="widget widget_kratos_about clearfix"><div class=photo-background></div><div class="photo-wrapper clearfix"><div class="photo-wrapper-tip text-center"><a href=javascript:;><img class=about-photo src=/images/avatar.png alt=25H></a></div></div><div class=textwidget><p class=text-center><span style=font-size:10pt></span></p></div></aside><aside class="widget widget_toc clearfix"><h4 class=widget-title>文章目录</h4><div id=TableOfContents></div></aside><aside class="widget widget_categories clearfix"><h4 class=widget-title>分类目录</h4><ul><li><a title=code href=/categories/code.html>code</a></li><li><a title=作品 href=/categories/%E4%BD%9C%E5%93%81.html>作品</a></li><li><a title=未分类 href=/categories/%E6%9C%AA%E5%88%86%E7%B1%BB.html>未分类</a></li><li><a title=状态 href=/categories/%E7%8A%B6%E6%80%81.html>状态</a></li><li><a title=笔记 href=/categories/%E7%AC%94%E8%AE%B0.html>笔记</a></li><li><a title=转载 href=/categories/%E8%BD%AC%E8%BD%BD.html>转载</a></li></ul></aside><aside id=kratos_ad-2 class="widget widget_kratos_ad clearfix"><a href=/z/about.html#打赏-赞助><img class="carousel-inner img-responsive img-rounded" src=/images/rw.jpg></a></aside></div></aside></div></div></div><footer><div id=footer style=background:#23282d><div class=container><div class=row><div class="col-md-6 col-md-offset-3 footer-list text-center"><p class=kratos-social-icons></p><p>© 2022 <a href=https://blog.arae.cc/>ARAE</a>. All Rights Reserved.<br>Powered by <a href=https://gohugo.io/ target=_blank rel=nofollow>Hugo</a> Hosted by <a href=https://pages.github.com target=_blank rel=nofollow>Github Pages</a><br>Theme <a href=https://blog.arae.cc/>Rolla</a> Made by <a href=https://moedog.org/ target=_blank rel=nofollow>Moedog</a> Modified by <a href=https://blog.arae.cc/>25H</a></p></div></div></div><div class="cd-tool text-center"><div class="gotop-box active"><div class=gotop-btn><span class="fa fa-chevron-up"></span></div></div><div class=search-box><span class="fa fa-search"></span><form class=search-form id=searchform target=_blank role=search><input type=text name=wd id=search placeholder=Search... style=display:none></form></div></div></div></footer></div></div></body></html>