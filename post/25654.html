<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=renderer content=webkit><meta name=force-rendering content=webkit><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=generator content="Hugo 0.57.2"><meta name=author content=25H><meta name=copyright content=ARAE><meta name=robots content=all><meta name=keywords content=易语言,代码><meta name=description content="什么是一个高效的软件？一个高效的软件不仅应该比实现同样功能的软件运行得更快，还应该消耗更少的系统资源。程序的时间效率是指运行速度，空间效率是指程序占用内存或者外存的状况。另外程序的效率我们也可以分为全局效率和局部效率。全局效率是指站在整个系统的角度上考虑的效率，局部效率是指站在模块或函数角度上考虑的 …"><title>如何编写高质量的易语言代码？ - ARAE</title><link rel=icon href=/images/favicon.png><link rel=canonical href=https://blog.arae.cc/post/25654.html><link rel=stylesheet href=/assets/style.min.css><script src=/assets/script.min.js></script></head><body><div id=kratos-wrapper><div id=kratos-page><div id=kratos-header><header id=kratos-header-section><div class=container><div class=nav-header><nav id=kratos-menu-wrap class=menu-main-container><ul id=kratos-primary-menu class=sf-menu><li class=current-menu-item><a href=/ aria-current=page><i class="fa fa-home"></i>&nbsp;首页</a></li><li><a href=/categories/%E7%8A%B6%E6%80%81.html><i class="fa fa-at"></i>&nbsp;状态</a></li><li><a href=javascript:;><i class="fa fa-folder-o"></i>&nbsp;分类</a><ul class=sub-menu><li><a href=/categories/code.html>Coding</a></li><li><a href=/categories/%E4%BD%9C%E5%93%81.html>作品</a></li><li><a href=/categories/%E7%AC%94%E8%AE%B0.html>笔记</a></li><li><a href=/categories/%E8%BD%AC%E8%BD%BD.html>转载</a></li><li><a href=/categories/%E6%9C%AA%E5%88%86%E7%B1%BB.html>未分类</a></li></ul></li><li><a href=/z/projects.html><i class="fa fa-bug"></i>&nbsp;项目</a></li><li><a href=/z/links.html><i class="fa fa-mars"></i>&nbsp;友链</a></li><li><a href=/z/about.html><i class="fa fa-rocket"></i>&nbsp;关于</a></li></ul></nav></div></div></header></div><div class="kratos-start kratos-hero-2"><div class=kratos-overlay></div><div class="kratos-cover kratos-cover_2 text-center"><div class="desc desc2 animate-box"><a href=https://blog.arae.cc/><h2>25H's Blog</h2><br><span></span></a></div></div></div><div id=kratos-blog-post style=background:#f5f5f5><div id=container class=container style=opacity:1><div class=row><section id=main class=col-md-8><article><div class="kratos-hentry kratos-post-inner clearfix"><header class=kratos-entry-header><h1 class="kratos-entry-title text-center">如何编写高质量的易语言代码？</h1><div class="kratos-post-meta text-center"><span title="2016-06-25 14:37:51"><i class="fa fa-calendar"></i>&nbsp;2016年06月25日</span>
<span><i class="fa fa-folder-o"></i>&nbsp;<a class=label href=/categories/%E6%9C%AA%E5%88%86%E7%B1%BB.html>未分类</a></span><span title="文章字数： ≈ 3215 字"><i class="fa fa-file-word-o"></i>&nbsp;3.21k</span>
<span title="阅读时长： ≈ 7 分钟"><i class="fa fa-clock-o"></i>&nbsp;7min</span>
<span><i class="fa fa-user"></i>&nbsp;25H</span></div></header><div class=kratos-post-content><p>什么是一个高效的软件？一个高效的软件不仅应该比实现同样功能的软件运行得更快，还应该消耗更少的系统资源。程序的时间效率是指运行速度，空间效率是指程序占用内存或者外存的状况。另外程序的效率我们也可以分为全局效率和局部效率。全局效率是指站在整个系统的角度上考虑的效率，局部效率是指站在模块或函数角度上考虑的效率。</p><h3 id=使用整数和长整数>使用整数和长整数</h3><p>　　提高代码运行速度最简单的方法莫过于使用正确的数据类型了。也许你不相信，但是</p><p>正确地选择数据类型可以大幅度提升代码的性能。在大多数情况下，程序员可以将短整数型、小数型和双精度小数型的变量替换为整数（Integer）或长整数（Long）类型的变量，因为易语言处理整数和长整数的能力远远高于处理其它几种数据类型。</p><p>　　在大多数情况下，程序员选择使用小数型或双精度小数型的原因是因为它们能够保存小数。但是小数也可以保存在整数类型的变量中。例如程序中约定有三位小数，那么只需要将保存在整数型变量中的数值除以1000就可以得到结果。根据我的经验，使用整数和长整数替代短整数型、小数型和双精度小数型后，代码的运行速度可以提高将近10倍。</p><p>但是我们也不要老是强调使用使用整数和长整数，因为在程序中数据类型的定义还牵涉一个关键的问题,就是数据的安全,频繁而无规范地定义 数据类型会使算法出现漏洞,是数据的安全和临界判断有问题.对财务和工程计算而言,小数点的精度是很敏感的数据,只能用双精度数据来规范.另外, 换成整型也会导致程序可读性急剧下降.</p><h3 id=避免使用通用型数据>避免使用通用型数据</h3><p>　　通用型的变量需要16个字节的空间来保存数据，而一个整数（Integer）只需要2个字节。通常使用通用型变量的目的是为了减少设计的工作量和代码量，也有的程序员图个省事而使用它。但是如果一个软件经过了严格设计和按照规范编码的话，完全可以避免使用变体类型。</p><h3 id=尽量避免使用属性>尽量避免使用属性</h3><p>　　在平时的代码中，最常见的比较低效的代码就是在可以使用变量的情况下，反复使用属性（Property），尤其是在循环中。要知道存取变量的速度是存取属性的速度的20倍左右。下面这段代码是很多程序员在程序中会使用到的：</p><p>容器名： 数值 类型：整数型</p><p>容器名： 容器 类型：整数型</p><p>计次循环首（7，容器）</p><p>文本1.内容 = 文本1.内容 + #换行符 + 到文本（（数值×容器））</p><p>计次循环尾（）</p><p>　　下面这段代码的执行速度是上面代码的20倍。</p><p>容器名： 数值 类型：整数型</p><p>容器名： 容器 类型：整数型</p><p>容器名： 文本 类型：文本型</p><p>文本 = 文本1.内容</p><p>计次循环首（7，容器）</p><p>文本 = 文本 + #换行符 + 到文本（（数值×容器））</p><p>计次循环尾（）</p><p>文本1.内容 = 文本</p><p>另外要注意，这个涉及一个编程思路， 用属性当变量的作法大多数情况可以简化算法。所以有时候也不能一味强调用变量代替属性。</p><h3 id=避免调用很短的子程序>避免调用很短的子程序</h3><p>　　调用只有几行代码的子程序也是不经济的&ndash;调用子程序所花费的时间或许比执行子程序中的代码需要更长的时间。在这种情况下，你可以把子程序中的代码拷贝到原来调用子程序的地方。</p><p>但是有时候小的子程序可能会被调用很多次而不是只有两三次，这时就应该调用它。</p><h3 id=减少对子对象的引用>减少对子对象的引用</h3><p>　　在易语言中，通过使用.来实现对象的引用。例如：</p><p>窗口1.编辑框1.内容</p><p>　　在上面的例子中，程序引用了两个对象：窗口1和编辑框1。利用这种方法引用效率很低。但遗憾的是，没有办法可以避免它。我的“多媒体模块”就有这个缺点。</p><h3 id=检查文本型数据是否为空>检查文本型数据是否为空</h3><p>　　大多数易语言用户在检查文本型数据是否为空时会使用下面的方法：</p><p>如果 （文本1.内容 = &ldquo;&rdquo; ）</p><p>注释： 执行操作</p><p>结束如果</p><p>　　很不幸，进行字符串比较需要的处理量甚至比读取属性还要大。因此我建议大家使用下面的方法：</p><p>如果 （到数值(文本1.内容) = 0 ）</p><p>注释： 执行操作</p><p>结束如果</p><p>另一个不同的意见是：问题在于当文本字串为 &ldquo;ABC&rdquo;之类的非数值型时, 到数值(&ldquo;ABC&rdquo;)=0并不表示为空。文本比较的效率并不低,在底层算法中,一般会直接比较长度才会继续比较内容。</p><h3 id=使用数组-而不是多个变量>使用数组，而不是多个变量</h3><p>　　当你有多个保存类似数据的变量时,可以考虑将他们用一个数组代替。在易语言中，数组是最高效的数据结构之一。</p><h3 id=尽量使用动态数组-而不是静态数组>尽量使用动态数组，而不是静态数组</h3><p>　　使用动态数组对代码的执行速度不会产生太大的影响，但是在某些情况下可以节约大量的资源。</p><h3 id=销毁对象>销毁对象</h3><p>　　无论编写的是什么软件，程序员都需要考虑在用户决定终止软件运行后释放软件占用的内存空间。但遗憾的是很多用户对这一点好像并不是很在意。正确的做法是在退出程序前需要销毁程序中使用的对象。例如：关闭数据库：关闭（数据库名称）、全部关闭（），关闭打开（播放）的文件，关闭载入的图片等。</p><p>中止程序执行时应该要关闭打开的文件（包括数据库文件、图片文件等），但是窗口销毁对销毁窗口及窗口单元来说是自动的,已足够做释放用,在窗口内最好不要随意销毁窗口单元,可能会导致程序运行中的潜在的单元数据访问而崩溃.只有在图形buffer情况才需要经常销毁。</p><h3 id=尽量使用内部子程序-减少易模块的数量>尽量使用内部子程序，减少易模块的数量</h3><p>因为从易语言连接到一个外部对象需要耗费大量的CPU处理能力。每当你调用接口函数的时候，都会浪费大量的系统资源。</p><p>另外只有在易模块中的接口函数或变量被调用时，易语言才将易模块加载到内存中；当易语言应用程序退出时，才会从内存中卸载这些模块。如果代码中只有一个模块，易语言就只会进行一次加载操作，这样代码的效率就得到了提高；反之如果代码中有多个模块，易语言会进行多次加载操作，代码的效率会降低。</p><h3 id=使用对象数组>使用对象数组</h3><p>　　当设计用户界面时，对于同样类型的控件，程序员应该尽量使用对象数组。你可以做一个实验：在窗口上添加100个图片框，每个图片框都有不同的名称，运行程序。然后创建一个新的工程，同样在窗口上添加100个图片框，不过这一次使用对象数组，运行程序，你可以注意到两个程序加载时间上的差别。</p><p>也有人认为两者从逻辑上看效率应该差不多。</p><h3 id=使用窗口单元-移动-方法>使用窗口单元“移动”方法</h3><p>　　在改变对象的位置时，有些用户喜欢使用“宽度”、“高度”、“顶边”和“左边”属性。例如：</p><p>按钮1.宽度 = 100</p><p>按钮1.高度 = 100</p><p>按钮1.顶边 = 0</p><p>按钮1.左边 = 0</p><p>　　实际上这样做效率很低，因为程序修改了四个属性，而且每次修改之后，窗口都会被重绘。正确的做法是使用Move方法：</p><p>按钮1.移动（0,0,100,100）</p><h3 id=减少图片的使用>减少图片的使用</h3><p>　　图片将占用大量内存，而且处理图片也需要占用很多CPU资源。在软件中，如果可能的话，可以考虑用背景色来替代图片&ndash;当然这只是从技术人员的角度出发看这个问题。</p><p>但是如果为了优化程序界面，使用图形换来的好处可能远胜节约下的资源，否则就不会有XP,也不会有游戏的进步了。</p><h3 id=编译优化>编译优化</h3><p>易语言的程序编译有三个选项：“编译”、“独立编译”、“编译生成安装软件”。优先使用的次序应该是“编译生成安装软件”、“编译”、“独立编译”，因为“独立编译”会将易语言系统中所有的支持库都编译进去，而“编译生成安装软件”只选择程序中必要的支持库编译。要脱离易语言环境也可以运行，就不要使用“编译”而应用“编译生成安装软件”或“独立编译”。</p><p>总结：执行效率和程序可读性永远是对矛盾 ，两者应该通盘考虑；资源占用和程序易用性永远是对矛盾，两者也应该通盘考虑。基于此，下面探讨一些提高程序的效率的规则。</p><p>【规则1】不要一味地追求程序的效率，应当在满足正确性、可靠性、健壮性、可读性等质量因素的前提下，设法提高程序的效率。</p><p>【规则2】以提高程序的全局效率为主，提高局部效率为辅。</p><p>【规则3】在优化程序的效率时，应当先找出限制效率的“瓶颈”，不要在无关紧要之处优化。</p><p>【规则4】先优化数据结构和算法，再优化执行代码。先考虑某功能是否可以用函数（命令）来实现，如果找不到这样的函数，再考虑用其他代码实现。</p><p>【规则5】有时候时间效率和空间效率可能对立，此时应当分析那个更重要，作出适当的折衷。例如多花费一些内存来提高性能。</p><p>【规则6】不要在什么时候都只追求紧凑的代码，因为紧凑的代码并不能产生高效的机器码。</p></div><div class="kratos-copyright text-center clearfix"><h5>本作品采用 <a rel="license nofollow" target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/ title="CC BY-NC-SA 4.0">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a> 进行许可</h5></div><footer class="kratos-entry-footer clearfix"><div class="post-like-donate text-center clearfix"><a href=javascript:; class=Donate><i class="fa fa-bitcoin"></i>&nbsp;打赏</a></div><div class="footer-tag clearfix"><div class=pull-left><i class="fa fa-tags"></i>&nbsp;
<a href=/tags/%E6%98%93%E8%AF%AD%E8%A8%80.html rel=tag>易语言</a>
<a href=/tags/%E4%BB%A3%E7%A0%81.html rel=tag>代码</a></div><div class=pull-date><span title="2019年08月30日 21:57:22">最后编辑：2019年08月30日</span></div></div></footer></div><nav class="navigation post-navigation clearfix" role=navigation><div class="nav-previous clearfix"><a title="梦代码编辑框支持库 （2.1#0版）" href=/post/25680.html>&lt; 上一篇</a></div><div class=nav-next><a title="软件开发人员的作战手册 - 让程序员活的久一点" href=/post/25686.html>下一篇 &gt;</a></div></nav><div id=comments class=comments-area><div id=comments-body data-pid=/post/25654.html><p class=mClose>评论功能被我吃了。</p></div></div></article></section><aside id=kratos-widget-area class="col-md-4 hidden-xs hidden-sm scrollspy"><div id=sidebar class=affix-top><aside class="widget widget_kratos_about clearfix"><div class=photo-background></div><div class="photo-wrapper clearfix"><div class="photo-wrapper-tip text-center"><a href=javascript:;><img class=about-photo src=/images/avatar.png alt=25H></a></div></div><div class=textwidget><p class=text-center><span style=font-size:10pt></span></p></div></aside><aside class="widget widget_toc clearfix"><h4 class=widget-title>文章目录</h4><div id=TableOfContents></div></aside><aside class="widget widget_categories clearfix"><h4 class=widget-title>分类目录</h4><ul><li><a title=code href=/categories/code.html>code</a></li><li><a title=作品 href=/categories/%E4%BD%9C%E5%93%81.html>作品</a></li><li><a title=未分类 href=/categories/%E6%9C%AA%E5%88%86%E7%B1%BB.html>未分类</a></li><li><a title=状态 href=/categories/%E7%8A%B6%E6%80%81.html>状态</a></li><li><a title=笔记 href=/categories/%E7%AC%94%E8%AE%B0.html>笔记</a></li><li><a title=转载 href=/categories/%E8%BD%AC%E8%BD%BD.html>转载</a></li></ul></aside><aside id=kratos_ad-2 class="widget widget_kratos_ad clearfix"><a href=/z/about.html#打赏-赞助><img class="carousel-inner img-responsive img-rounded" src=/images/rw.jpg></a></aside></div></aside></div></div></div><footer><div id=footer style=background:#23282d><div class=container><div class=row><div class="col-md-6 col-md-offset-3 footer-list text-center"><p class=kratos-social-icons></p><p>© 2023 <a href=https://blog.arae.cc/>ARAE</a>. All Rights Reserved.<br>Powered by <a href=https://gohugo.io/ target=_blank rel=nofollow>Hugo</a> Hosted by <a href=https://pages.github.com target=_blank rel=nofollow>Github Pages</a><br>Theme <a href=https://blog.arae.cc/>Rolla</a> Made by <a href=https://moedog.org/ target=_blank rel=nofollow>Moedog</a> Modified by <a href=https://blog.arae.cc/>25H</a></p></div></div></div><div class="cd-tool text-center"><div class="gotop-box active"><div class=gotop-btn><span class="fa fa-chevron-up"></span></div></div><div class=search-box><span class="fa fa-search"></span><form class=search-form id=searchform target=_blank role=search><input type=text name=wd id=search placeholder=Search... style=display:none></form></div></div></div></footer></div></div></body></html>